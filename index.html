<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.15.1/dist/phaser-arcade-physics.min.js"></script>
</head>
<body>

    <script>
    var config = {
        type: Phaser.AUTO,
        width: 740,
        height: 580,
        physics: {
            default: 'arcade',
            arcade: {
                gravity: { y: 200 }
            }
        },
        scene: {
            preload: preload,
            create: create,
            update: update
        }
    };

    var game = new Phaser.Game(config);

    var sprite;
    var cursors;
    var player;
    var rocks;
    var logs;
    var direction;
    var beaver = 'norb';

    function preload ()
    {
        this.load.image('logo', 'assets/images/water.gif');
        this.load.image('rock', 'assets/images/rock.png');
        this.load.image('death', 'assets/images/death.png');
        this.load.image('log', 'assets/images/log.png');
        this.load.spritesheet('water', 'assets/images/watersheet.png',{ frameWidth: 370, frameHeight: 361 });
        this.load.spritesheet('norb', 'assets/images/norbsheet.png',{ frameWidth: 500, frameHeight: 500 });
        this.load.spritesheet('dag', 'assets/images/dagsheet.png',{ frameWidth: 500, frameHeight: 500 });
  //     this.load.spritesheet('sky', 'assets/images/water1.png', 368, 359);
  //      this.load.spritesheet('sky', 'assets/images/watersheet.png', 370, 361);
    }

    function create ()
    {
          var config = {
              key: 'movingwater',
              frames: this.anims.generateFrameNumbers('water', { start: 0, end: 2 }),
              frameRate: 7,
              repeat: -1
          };

        this.anims.create(config);
        this.add.sprite(185, 181, 'water').play('movingwater');
        this.add.sprite(555, 181, 'water').play('movingwater');
        this.add.sprite(185, 542, 'water').play('movingwater');
        this.add.sprite(555, 542, 'water').play('movingwater');

        rocks = this.physics.add.staticGroup();

        rocks.create(0, 560, 'rock');
        rocks.create(60, 560, 'rock');
        rocks.create(135, 565, 'rock');
        rocks.create(215, 570, 'rock');
        rocks.create(300, 572, 'rock');
        rocks.create(358, 570, 'rock');
        rocks.create(445, 565, 'rock');
        rocks.create(500, 560, 'rock');
        rocks.create(580, 560, 'rock');
        rocks.create(680, 560, 'rock');

        logs = this.physics.add.staticGroup();
        rocks.create(215, 320, 'log');

            this.anims.create({
                key: 'norbLeft',
                frames: this.anims.generateFrameNumbers('norb', { start: 0, end: 8 }),
                frameRate: 10,
                repeat: -1
            });

            this.anims.create({
                key: 'norbUpLeft',
                frames: this.anims.generateFrameNumbers('norb', { start: 0, end: 8 }),
                frameRate: 24,
                repeat: -1
            });

            this.anims.create({
                key: 'norbRight',
                frames: this.anims.generateFrameNumbers('norb', { start: 9, end: 15 }),
                frameRate: 10,
                repeat: -1
            });

            this.anims.create({
                key: 'norbUpRight',
                frames: this.anims.generateFrameNumbers('norb', { start: 9, end: 15 }),
                frameRate: 24,
                repeat: -1
            });

            this.anims.create({
                key: 'dagLeft',
                frames: this.anims.generateFrameNumbers('dag', { start: 0, end: 8 }),
                frameRate: 10,
                repeat: -1
            });

            this.anims.create({
                key: 'dagUpLeft',
                frames: this.anims.generateFrameNumbers('dag', { start: 0, end: 8 }),
                frameRate: 24,
                repeat: -1
            });

            this.anims.create({
                key: 'dagRight',
                frames: this.anims.generateFrameNumbers('dag', { start: 9, end: 15 }),
                frameRate: 10,
                repeat: -1
            });

            this.anims.create({
                key: 'dagUpRight',
                frames: this.anims.generateFrameNumbers('dag', { start: 9, end: 15 }),
                frameRate: 24,
                repeat: -1
            });

        player = this.physics.add.sprite(180, 180, 'norb').play('norbRight');
        //var norb = this.add.sprite(185, 181, 'norb').play('norbSwimming');
        player.setCollideWorldBounds(true);

        player.displayWidth = 65;
        player.scaleY = player.scaleX;

         // this.anims.create({
         //         key: 'right',
         //         frames: this.anims.generateFrameNumbers('water', { start: 0, end: 2 }),
         //         frameRate: 10,
         //         repeat: -1
         //     });

        // var particles = this.add.particles('red');

        // var emitter = particles.createEmitter({
        //     speed: 100,
        //     scale: { start: 1, end: 0 },
        //     blendMode: 'ADD'
        // });

        // var logo = this.physics.add.image(400, 100, 'logo');
        //
        // logo.setVelocity(100, 200);
        // logo.setBounce(1, 1);
        // logo.setCollideWorldBounds(true);

        // emitter.startFollow(logo);
        this.physics.add.collider(player, rocks);
        cursors = this.input.keyboard.createCursorKeys();
    }

    function update(){
      if(cursors.up.isDown && cursors.left.isDown){
          direction = 'left';
          player.setVelocityX(-160);
          player.anims.play(beaver+'UpLeft', true);
      }
      else if(cursors.up.isDown && cursors.right.isDown){
          direction = 'right';
          player.setVelocityX(160);
          player.anims.play(beaver+'UpRight', true);
      }
      else if(cursors.up.isDown && direction === 'left'){
          player.setVelocityX(0);
          player.anims.play(beaver+'UpLeft', true);
      }
      else if(cursors.up.isDown && direction === 'right'){
          player.setVelocityX(0);
          player.anims.play(beaver+'UpRight', true);
      }
      else if (cursors.left.isDown)
      {
          direction = 'left';
          player.setVelocityX(-160);
          player.anims.play(beaver+'Left', true);
      }
      else if (cursors.right.isDown)
      {
          direction = 'right';
          player.setVelocityX(160);
          player.anims.play(beaver+'Right', true);
      }
      else
      {
          if(direction === 'left'){
            player.anims.play(beaver+'Left', true);
          } else{
            player.anims.play(beaver+'Right', true);
          }
          player.setVelocityX(0);
          player.setVelocityY(150);
      }

      if (cursors.up.isDown)
      {
          player.setVelocityY(-170);
      }

      if(player.body.touching.down){
        var poop = 'poop';
      }
    }
    </script>

</body>
</html>
